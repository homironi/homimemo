---
id: u7ax9hdyzzu3zkp5grbjazmt
title: 個人サイトの技術【v.2.0.0】Next.jsにしてみた！
draft: false
publishDate: 2025-09-09T00:05:00.000Z
lastModDate: 2025-12-10T12:07:35.000Z
tags:
  - Web制作
  - Next.js
  - Cloudflare
  - このサイトについて
description: 当サイトの制作についての記事です。今回はNext.jsのSSGで作成するようにリニューアルしました！
thumbnail: /images/header/articles/u7ax9hdyzzu3zkp5grbjazmt.webp
---
## はじめに

サイト制作をしやすくするために、[Next.js](https://nextjs.org/)へのリニューアルを行いました！  
もともとC++やC#をやっているので、[11ty](https://www.11ty.dev/)（Nunjucks）はなかなか扱いにくかったのです。  
とはいえWeb制作に関する知識が「なんか、HTMLとCSSってやつでできてるんだよね？」くらいしかなかった当時にはぴったりでした。  
ありがとう11ty！ ありがとうNunjucks！

<TextBlock blockType="note">
11tyのコードが気になる方はリポジトリのタグから最後のコミットが確認できます。

https://github.com/homironi/homimemo/releases/tag/11ty-latest
</TextBlock>

Next.jsやTypeScriptでのWeb制作についての知識を得たところで、サイトも置き換えたいなと思ったので置き換えました！

https://github.com/homironi/homimemo


▼ 流れなどは以前とあまり変わりありませんので、前回の記事もチラ見を推奨します。

https://homironi.com/articles/iaumv89u70tjyr7c7e0y0gyw/

## この記事を読むと？

- [x] 個人サイトを作る際の技術選定の雰囲気がわかる！
- [x] Next.jsでSSGする方法がざっくりつかめる！

## 運営にかかる金額

年間1600円くらい（ドルなので日本円換算で変動あり）の予定です！

ドメイン代のみで運営できる予定です。  
ドメインは今後[Cloudflare Registrar](https://cfdomainpricing.com/)に移管する予定なので、以降は`.com`の10.44ドル（2025/10/28現在）です。

### これまでの金額

これまではレンタルサーバーを借りていたので年間1万円以上でした。  

Cloudflare Workersにデプロイするように変更したので、サーバーが不要になりました。  
ドメイン代はレンタルサーバーのプランに特典として契約中は使用できる、として含まれていました。  
今後はサーバーの契約終了前に特典扱いを解除してもらい、移管する予定です。

## 技術スタック

以下や他のライブラリも含めて選定理由はすべて「楽しそうだから」です！  
このサイトは好奇心だけで形成されています。よろしくお願いします！

- Next.js
- TypeScript
- ~~[DecapCMS](https://decapcms.org/)~~
- markdown

Next.jsでSSG → Cloudflare Workersにデプロイという流れで運用しています。

<TextBlock blockType="info">
エックスサーバー → [Cloudflare Workers](https://www.cloudflare.com/ja-jp/developer-platform/products/workers/)に移行しました。  
今後はドメイン代のみで運用できる予定です！  
Cloudflare Workersは無料枠でも十分いろいろできてすごいです。
</TextBlock>

記事などを管理しているCMSのDecapCMSはAPIを叩くタイプではなく、リポジトリにマークダウンファイルを保存してくれるタイプのCMSです。  
そのため、Next.jsでのビルド時にマークダウンファイルを読み込んでビルドしています。  
【2025/12/10追記】DecapCMSを使わなくなりました。使い心地がどうのという話ではなく、単純にローカルでの記事作成が多くなったので、Web上で作る必要もなくなったためです。  

<TextBlock blockType="note">
余談ですが、パッケージマネージャーもnpmからpnpmに変更しました。  
依存関係のインストールがはやくてすてきです！ わーい！
</TextBlock>

## 流れ

[以前](https://homironi.com/articles/iaumv89u70tjyr7c7e0y0gyw/)とあまり変わりありません。

1. マークダウン（VSCode ~~もしくは DecapCMS を通して~~）で記事を書く
2. Next.jsでSSG（ビルド）
3. `main`ブランチにマージされたら、公開される

### DecapCMS

<TextBlock blockType="note" title="2025/12/10追記">
DecapCMSを使わなくなりました。使い心地がどうのという話ではなく、単純にローカルでの記事作成が多くなったので、Web上で作る必要もなくなったためです。  
記事作成時の内容を残しますが、現在はDecapCMSなしでローカルで記事を作成しています。
</TextBlock>

今回のリニューアルに合わせてDecapCMSというCMSを入れました。  

<TextBlock blockType="info" title="CMSとは">
CMSはコンテンツ・マネジメント・システム（Contents Management System）の略称です。  
Webサイトの記事のデータなどを管理する際によく使われます。
</TextBlock>

DecapCMSを入れたのは「FrontMatterをUIで扱いたかったから」です。  
11tyの頃と変わらず、マークダウンファイルの先頭の「FrontMatter」というデータを使って記事の本文以外のデータを管理しています。  

FrontMatterとは、記事冒頭にあるメタ情報のことです。

```md
---
title: これは記事タイトル
publishDate: 2025-09-08T19:44:00.000Z
---
ここから先は記事本文のマークダウンデータ。
```

このFrontMatterを11tyのときは手入力していました。
ですが、「更新日時はなんて名前だっけ」ということが多く、以前の記事からコピペしてくることが多かったのです。  
これが面倒でいろいろ調べた結果、CMSを入れてWeb上のUIで日時やタイトルなどを入力するようにすることで、`title`の部分などをコピペせずに済むようになりました！

▼ いろいろ設定すると、以下のようなWeb上のUIで入力できるようになります（本文もいけます！）。  
![DecapCMSのスクリーンショット](/images/article/u7ax9hdyzzu3zkp5grbjazmt/DecapCMS.webp)

### Next.jsでビルド

以下のように[`next.config.ts`](https://github.com/homironi/homimemo/blob/main/next.config.ts)で`output`に`"export"`を指定することでSSGとして扱うことができます。  
このビルドされたデータを公開することで、サイトが公開できます。  
Cloudflare WorkersならNext.jsをSSGせずにそのまま動かすこともできましたが、更新頻度も高くなかったので都度ビルドするようにしています。

```ts
import type { NextConfig } from "next";

const nextConfig: NextConfig = {
  output: "export",
  distDir: "_public", // ビルドしたものの出力フォルダの指定
  // other
};

export default nextConfig;
```

TypeScriptが使えると型安全に扱えて嬉しいです。  
型安全だいすきです。

### Cloudflare Workers

無料でもかなりいろいろ使えるということを知り、エックスサーバーからCloudflare Workersに移動してみました。  
公式のドキュメントも充実していて、無料でもいろいろできて、とても楽しいです！

▼ 移行した際にCloudflareWorkersでリダイレクトの設定をしたときのメモ記事も公開しました！

https://homironi.com/articles/1rzo1xgl9sna9y2apleb8of4/

## GitHubActions周り

ビルド周りに関してはCloudflare Workersに移行したことで不要になったので削除しました。

記事にランダムなidを振りたかったので、記事マークダウンファイルの差分があるときだけ、記事idがあるか確認してなければ追加するスクリプトを動かしています。  
基本的に`tsx`を使用してTypeScriptで書いたものを、GitHubActionsで実行させるかたちでやっています。

### その他細かいところ

- `next-mdx-remote`と`gray-matter`でparse
  - マークダウンファイルはルーティングに使用したくなかった＆CMSからデータが変更しやすい場所に置きたかった
- `valibot`でparseした記事のメタ情報の検証
  - 型安全だいすき

### ブランチ運用ルール

これは以前からですが、ブランチは以下のように使い分けています。

|ブランチ名|用途|
|--|--|
|`main`|公開用|
|`develop`|開発用。PRのマージ先をミスらないようにデフォルトブランチに設定|
|`feature/hoge`|とりあえずこのブランチで何かを追加する|

## 最後に

ちょこちょこ細かいところは別途記事にできたらいいなと思っています。  
Componentにまとめられることで管理がしやすくなり、無駄な繰り返しもかなり減らせました！  
リニューアルとっても楽しかったです！

## 関連

https://github.com/homironi/homimemo

https://homironi.com/articles/1rzo1xgl9sna9y2apleb8of4/

https://homironi.com/articles/iaumv89u70tjyr7c7e0y0gyw/

https://www.11ty.dev/

https://nextjs.org/

https://www.cloudflare.com/ja-jp/developer-platform/products/workers/
