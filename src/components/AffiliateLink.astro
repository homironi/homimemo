---
import { rakutenWidgetHtml } from "@/data/affiliateLinks";
import { getEntry } from "astro:content";

export type Props = { type: "rakutenWidget" } | { type: "productLink"; id: string };

const props = Astro.props; 

const affiliateHtml = props.type === "rakutenWidget" ? rakutenWidgetHtml : (await getEntry("affiliates", props.id))?.body;
if(!affiliateHtml){
  throw new Error(`Not found affiliate html.${props.type === "productLink" && ` id: ${props.id}`}`);
}
---

<div class="container">
  <Fragment set:html={affiliateHtml} />
</div>

<style>
  .container {
    margin: 0 auto;
    padding: 8px;
    max-width: 100%;
    background-color: var(--color-main);
    border: solid 1px var(--border-color-main);
  }
  
  .container::before{
    content: "広告";
    color: var(--text-color-pale);
    display: block;
    font-size: 0.75rem;
    padding-bottom: 4px;
  }

  :global(.easyLink-info-btn-amazon) {
    /* 生成されるかんたんリンクの文字色を強制的に上書きするため、importantを使用 */
    color: var(--text-color-black) !important;
  }
</style>
