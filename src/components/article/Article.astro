---
import JsonLd from "@/components/JsonLd.astro";
import { createArticleJsonLd, createStaticArticleJsonLd } from "@/lib/jsonLd";
import { isArticleMeta, type ArticleMeta, type StaticPageMetaWithSlug } from "@/schemas/article/meta";
import type { AstroComponentFactory } from "astro/runtime/server/index.js";
import ArticleContent from "./ArticleContent.astro";

export type ArticleComponentMeta = ArticleMeta | StaticPageMetaWithSlug;

interface Props {
  meta: ArticleComponentMeta;
  content: AstroComponentFactory;
  shareSlug: string;
};

const { meta, content } = Astro.props;

// 通常の記事どうか：falseなら固定記事（aboutやcontact）
const isArticle = isArticleMeta(meta);
---

<Fragment slot="head">
  { isArticle
      ? <JsonLd schema={ createArticleJsonLd(meta) } />
      : <JsonLd schema={ createStaticArticleJsonLd(meta) } />
    }
</Fragment>
<!-- TODO：記事レイアウト作る -->
<p>{isArticle && meta.id}：{meta.title}</p>
<p>{meta.description}</p>
<hr>
<ArticleContent content={content} />
